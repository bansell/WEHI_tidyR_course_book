<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 4. Part 3 | Introduction to R - tidyverse</title>
  <meta name="description" content="Week 4. Part 3 | Introduction to R - tidyverse" />
  <meta name="generator" content="bookdown 0.17.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 4. Part 3 | Introduction to R - tidyverse" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 4. Part 3 | Introduction to R - tidyverse" />
  
  
  

<meta name="author" content="Brendan R. E. Ansell @ansellbr3" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-4-part-2.html"/>
<link rel="next" href="odds-ends.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162666902-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-162666902-1');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i>How to use this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#before-we-begin"><i class="fa fa-check"></i>Before we begin</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-1-part-1.html"><a href="week-1-part-1.html"><i class="fa fa-check"></i>Week 1. Part 1</a></li>
<li class="chapter" data-level="1" data-path="welcome-to-r.html"><a href="welcome-to-r.html"><i class="fa fa-check"></i><b>1</b> Welcome to R!</a><ul>
<li class="chapter" data-level="1.1" data-path="welcome-to-r.html"><a href="welcome-to-r.html#a-look-around-rstudio"><i class="fa fa-check"></i><b>1.1</b> A look around RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="welcome-to-r.html"><a href="welcome-to-r.html#console-pane"><i class="fa fa-check"></i><b>1.2</b> Console Pane</a></li>
<li class="chapter" data-level="1.3" data-path="welcome-to-r.html"><a href="welcome-to-r.html#environmenthistory-pane"><i class="fa fa-check"></i><b>1.3</b> Environment/History Pane</a></li>
<li class="chapter" data-level="1.4" data-path="welcome-to-r.html"><a href="welcome-to-r.html#plotting-pane"><i class="fa fa-check"></i><b>1.4</b> Plotting Pane</a></li>
<li class="chapter" data-level="1.5" data-path="welcome-to-r.html"><a href="welcome-to-r.html#open-a-new-r-script"><i class="fa fa-check"></i><b>1.5</b> Open a new R script</a></li>
<li class="chapter" data-level="1.6" data-path="welcome-to-r.html"><a href="welcome-to-r.html#comments"><i class="fa fa-check"></i><b>1.6</b> Comments</a></li>
<li class="chapter" data-level="1.7" data-path="welcome-to-r.html"><a href="welcome-to-r.html#executing-commands"><i class="fa fa-check"></i><b>1.7</b> Executing commands</a></li>
<li class="chapter" data-level="1.8" data-path="welcome-to-r.html"><a href="welcome-to-r.html#simple-maths-in-r"><i class="fa fa-check"></i><b>1.8</b> Simple maths in R</a></li>
<li class="chapter" data-level="1.9" data-path="welcome-to-r.html"><a href="welcome-to-r.html#help"><i class="fa fa-check"></i><b>1.9</b> Help!!</a></li>
<li class="chapter" data-level="1.10" data-path="welcome-to-r.html"><a href="welcome-to-r.html#variables"><i class="fa fa-check"></i><b>1.10</b> Variables</a><ul>
<li class="chapter" data-level="1.10.1" data-path="welcome-to-r.html"><a href="welcome-to-r.html#a-note-on-variables"><i class="fa fa-check"></i><b>1.10.1</b> A note on variables</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="welcome-to-r.html"><a href="welcome-to-r.html#vectors"><i class="fa fa-check"></i><b>1.11</b> Vectors</a><ul>
<li class="chapter" data-level="1.11.1" data-path="welcome-to-r.html"><a href="welcome-to-r.html#creating-numeric-vectors"><i class="fa fa-check"></i><b>1.11.1</b> Creating numeric vectors</a></li>
<li class="chapter" data-level="1.11.2" data-path="welcome-to-r.html"><a href="welcome-to-r.html#character-vectors"><i class="fa fa-check"></i><b>1.11.2</b> Character vectors</a></li>
<li class="chapter" data-level="1.11.3" data-path="welcome-to-r.html"><a href="welcome-to-r.html#logical-vectors"><i class="fa fa-check"></i><b>1.11.3</b> Logical vectors</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="welcome-to-r.html"><a href="welcome-to-r.html#packages"><i class="fa fa-check"></i><b>1.12</b> Packages</a><ul>
<li class="chapter" data-level="1.12.1" data-path="welcome-to-r.html"><a href="welcome-to-r.html#installing-packages"><i class="fa fa-check"></i><b>1.12.1</b> Installing packages</a></li>
</ul></li>
<li class="chapter" data-level="1.13" data-path="welcome-to-r.html"><a href="welcome-to-r.html#the-pipe"><i class="fa fa-check"></i><b>1.13</b> The pipe %&gt;%</a></li>
<li class="chapter" data-level="1.14" data-path="welcome-to-r.html"><a href="welcome-to-r.html#data-frames"><i class="fa fa-check"></i><b>1.14</b> Data frames</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-1-part-2.html"><a href="week-1-part-2.html"><i class="fa fa-check"></i>Week 1. Part 2</a></li>
<li class="chapter" data-level="2" data-path="making-beautiful-plots.html"><a href="making-beautiful-plots.html"><i class="fa fa-check"></i><b>2</b> Making beautiful plots</a><ul>
<li class="chapter" data-level="" data-path="making-beautiful-plots.html"><a href="making-beautiful-plots.html#introductory-information"><i class="fa fa-check"></i>Introductory information</a></li>
<li class="chapter" data-level="" data-path="making-beautiful-plots.html"><a href="making-beautiful-plots.html#ggplot2.-a-grammar-of-graphics"><i class="fa fa-check"></i>ggplot2. A grammar of graphics</a></li>
<li class="chapter" data-level="2.1" data-path="making-beautiful-plots.html"><a href="making-beautiful-plots.html#building-a-ggplot"><i class="fa fa-check"></i><b>2.1</b> Building a ggplot</a></li>
<li class="chapter" data-level="2.2" data-path="making-beautiful-plots.html"><a href="making-beautiful-plots.html#plot-background"><i class="fa fa-check"></i><b>2.2</b> Plot background</a></li>
<li class="chapter" data-level="2.3" data-path="making-beautiful-plots.html"><a href="making-beautiful-plots.html#aesthetics-aes"><i class="fa fa-check"></i><b>2.3</b> Aesthetics aes()</a></li>
<li class="chapter" data-level="2.4" data-path="making-beautiful-plots.html"><a href="making-beautiful-plots.html#geometric-representations-geom"><i class="fa fa-check"></i><b>2.4</b> Geometric representations geom()</a><ul>
<li class="chapter" data-level="2.4.1" data-path="making-beautiful-plots.html"><a href="making-beautiful-plots.html#a-note-about-and"><i class="fa fa-check"></i><b>2.4.1</b> A note about %&gt;% and +</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="making-beautiful-plots.html"><a href="making-beautiful-plots.html#adding-colour"><i class="fa fa-check"></i><b>2.5</b> Adding colour</a></li>
<li class="chapter" data-level="2.6" data-path="making-beautiful-plots.html"><a href="making-beautiful-plots.html#adding-layers"><i class="fa fa-check"></i><b>2.6</b> Adding layers</a></li>
<li class="chapter" data-level="2.7" data-path="making-beautiful-plots.html"><a href="making-beautiful-plots.html#facets"><i class="fa fa-check"></i><b>2.7</b> Facets</a></li>
<li class="chapter" data-level="2.8" data-path="making-beautiful-plots.html"><a href="making-beautiful-plots.html#coordinate-space"><i class="fa fa-check"></i><b>2.8</b> Coordinate space</a></li>
<li class="chapter" data-level="2.9" data-path="making-beautiful-plots.html"><a href="making-beautiful-plots.html#axis-labels"><i class="fa fa-check"></i><b>2.9</b> Axis labels</a></li>
<li class="chapter" data-level="2.10" data-path="making-beautiful-plots.html"><a href="making-beautiful-plots.html#themes"><i class="fa fa-check"></i><b>2.10</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-1-part-3.html"><a href="week-1-part-3.html"><i class="fa fa-check"></i>Week 1. Part 3</a></li>
<li class="chapter" data-level="3" data-path="making-more-beautiful-plots.html"><a href="making-more-beautiful-plots.html"><i class="fa fa-check"></i><b>3</b> Making <em>more</em> beautiful plots</a><ul>
<li class="chapter" data-level="" data-path="making-more-beautiful-plots.html"><a href="making-more-beautiful-plots.html#introductory-information-1"><i class="fa fa-check"></i>Introductory information</a></li>
<li class="chapter" data-level="3.1" data-path="making-more-beautiful-plots.html"><a href="making-more-beautiful-plots.html#bigger-data-54000-diamonds"><i class="fa fa-check"></i><b>3.1</b> Big(ger) Data: 54,000 diamonds</a></li>
<li class="chapter" data-level="3.2" data-path="making-more-beautiful-plots.html"><a href="making-more-beautiful-plots.html#geom_jitter"><i class="fa fa-check"></i><b>3.2</b> geom_jitter()</a></li>
<li class="chapter" data-level="3.3" data-path="making-more-beautiful-plots.html"><a href="making-more-beautiful-plots.html#summary-plots"><i class="fa fa-check"></i><b>3.3</b> Summary plots</a><ul>
<li class="chapter" data-level="3.3.1" data-path="making-more-beautiful-plots.html"><a href="making-more-beautiful-plots.html#free-examples"><i class="fa fa-check"></i><b>3.3.1</b> Free examples!</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="making-more-beautiful-plots.html"><a href="making-more-beautiful-plots.html#histograms"><i class="fa fa-check"></i><b>3.4</b> Histograms</a></li>
<li class="chapter" data-level="3.5" data-path="making-more-beautiful-plots.html"><a href="making-more-beautiful-plots.html#density-plots"><i class="fa fa-check"></i><b>3.5</b> Density plots</a></li>
<li class="chapter" data-level="3.6" data-path="making-more-beautiful-plots.html"><a href="making-more-beautiful-plots.html#box-plots"><i class="fa fa-check"></i><b>3.6</b> Box plots</a></li>
<li class="chapter" data-level="3.7" data-path="making-more-beautiful-plots.html"><a href="making-more-beautiful-plots.html#saving-plots"><i class="fa fa-check"></i><b>3.7</b> Saving plots</a></li>
<li class="chapter" data-level="3.8" data-path="making-more-beautiful-plots.html"><a href="making-more-beautiful-plots.html#challenge"><i class="fa fa-check"></i><b>3.8</b> Challenge</a></li>
<li class="chapter" data-level="3.9" data-path="making-more-beautiful-plots.html"><a href="making-more-beautiful-plots.html#solution"><i class="fa fa-check"></i><b>3.9</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-2-part-1.html"><a href="week-2-part-1.html"><i class="fa fa-check"></i>Week 2. Part 1</a></li>
<li class="chapter" data-level="4" data-path="sub-setting-vectors.html"><a href="sub-setting-vectors.html"><i class="fa fa-check"></i><b>4</b> Sub-setting vectors</a><ul>
<li class="chapter" data-level="4.1" data-path="sub-setting-vectors.html"><a href="sub-setting-vectors.html#subset-by-position"><i class="fa fa-check"></i><b>4.1</b> Subset by position</a></li>
<li class="chapter" data-level="4.2" data-path="sub-setting-vectors.html"><a href="sub-setting-vectors.html#adding-names"><i class="fa fa-check"></i><b>4.2</b> Adding names</a></li>
<li class="chapter" data-level="4.3" data-path="sub-setting-vectors.html"><a href="sub-setting-vectors.html#subset-by-condition"><i class="fa fa-check"></i><b>4.3</b> Subset by condition</a></li>
<li class="chapter" data-level="4.4" data-path="sub-setting-vectors.html"><a href="sub-setting-vectors.html#challenge-1"><i class="fa fa-check"></i><b>4.4</b> Challenge</a></li>
<li class="chapter" data-level="4.5" data-path="sub-setting-vectors.html"><a href="sub-setting-vectors.html#possible-solutions"><i class="fa fa-check"></i><b>4.5</b> Possible solutions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-2-part-2.html"><a href="week-2-part-2.html"><i class="fa fa-check"></i>Week 2. Part 2</a></li>
<li class="chapter" data-level="5" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html"><i class="fa fa-check"></i><b>5</b> Manipulating data with dplyr</a><ul>
<li class="chapter" data-level="5.1" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#filter"><i class="fa fa-check"></i><b>5.1</b> filter()</a><ul>
<li class="chapter" data-level="5.1.1" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#logical-operations"><i class="fa fa-check"></i><b>5.1.1</b> Logical operations</a></li>
<li class="chapter" data-level="5.1.2" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#str_detect-helper-function"><i class="fa fa-check"></i><b>5.1.2</b> str_detect() helper function</a></li>
<li class="chapter" data-level="5.1.3" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#in-helper"><i class="fa fa-check"></i><b>5.1.3</b> %in% helper</a></li>
<li class="chapter" data-level="5.1.4" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#is.na-helper"><i class="fa fa-check"></i><b>5.1.4</b> is.na() helper</a></li>
<li class="chapter" data-level="5.1.5" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#complete.cases-helper"><i class="fa fa-check"></i><b>5.1.5</b> complete.cases() helper</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#select"><i class="fa fa-check"></i><b>5.2</b> select()</a><ul>
<li class="chapter" data-level="5.2.1" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#contains-helper-function"><i class="fa fa-check"></i><b>5.2.1</b> contains() helper function</a></li>
<li class="chapter" data-level="5.2.2" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#starts_with-helper-function"><i class="fa fa-check"></i><b>5.2.2</b> starts_with() helper function</a></li>
<li class="chapter" data-level="5.2.3" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#everything-helper-function"><i class="fa fa-check"></i><b>5.2.3</b> everything() helper function</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>5.3</b> arrange()</a><ul>
<li class="chapter" data-level="5.3.1" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#desc-helper-function"><i class="fa fa-check"></i><b>5.3.1</b> desc() helper function</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#chaining-dplyr-functions"><i class="fa fa-check"></i><b>5.4</b> Chaining dplyr functions</a></li>
<li class="chapter" data-level="5.5" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#writing-data-to-a-file"><i class="fa fa-check"></i><b>5.5</b> Writing data to a file</a></li>
<li class="chapter" data-level="5.6" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#chaining-dplyr-and-ggplot"><i class="fa fa-check"></i><b>5.6</b> Chaining dplyr and ggplot</a></li>
<li class="chapter" data-level="5.7" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#mutate"><i class="fa fa-check"></i><b>5.7</b> mutate()</a><ul>
<li class="chapter" data-level="5.7.1" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#challenge-2"><i class="fa fa-check"></i><b>5.7.1</b> Challenge</a></li>
<li class="chapter" data-level="5.7.2" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#solution-1"><i class="fa fa-check"></i><b>5.7.2</b> Solution</a></li>
<li class="chapter" data-level="5.7.3" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#ifelse-helper"><i class="fa fa-check"></i><b>5.7.3</b> ifelse() helper</a></li>
<li class="chapter" data-level="5.7.4" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#case_when-helper"><i class="fa fa-check"></i><b>5.7.4</b> case_when() helper</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#summarize"><i class="fa fa-check"></i><b>5.8</b> summarize()</a><ul>
<li class="chapter" data-level="5.8.1" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#n-helper"><i class="fa fa-check"></i><b>5.8.1</b> n() helper</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#group_by-helper"><i class="fa fa-check"></i><b>5.9</b> group_by() helper</a><ul>
<li class="chapter" data-level="5.9.1" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#group_by-summarize"><i class="fa fa-check"></i><b>5.9.1</b> group_by() %&gt;% summarize()</a></li>
<li class="chapter" data-level="5.9.2" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#group_by-mutate"><i class="fa fa-check"></i><b>5.9.2</b> group_by() %&gt;% mutate()</a></li>
<li class="chapter" data-level="5.9.3" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#ungroup-helper"><i class="fa fa-check"></i><b>5.9.3</b> ungroup() helper</a></li>
<li class="chapter" data-level="5.9.4" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#count-helper"><i class="fa fa-check"></i><b>5.9.4</b> count() helper</a></li>
<li class="chapter" data-level="5.9.5" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#sample_n-helper"><i class="fa fa-check"></i><b>5.9.5</b> sample_n() helper</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#challenges"><i class="fa fa-check"></i><b>5.10</b> Challenges</a></li>
<li class="chapter" data-level="5.11" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#solutions"><i class="fa fa-check"></i><b>5.11</b> Solutions</a></li>
<li class="chapter" data-level="5.12" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#summary"><i class="fa fa-check"></i><b>5.12</b> Summary</a></li>
<li class="chapter" data-level="5.13" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#cheat-sheets"><i class="fa fa-check"></i><b>5.13</b> Cheat sheets!</a><ul>
<li class="chapter" data-level="5.13.1" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#ggplot-example"><i class="fa fa-check"></i><b>5.13.1</b> ggplot example</a></li>
<li class="chapter" data-level="5.13.2" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#dplyr-example"><i class="fa fa-check"></i><b>5.13.2</b> dplyr example</a></li>
</ul></li>
<li class="chapter" data-level="5.14" data-path="manipulating-data-with-dplyr.html"><a href="manipulating-data-with-dplyr.html#extra-resources"><i class="fa fa-check"></i><b>5.14</b> Extra resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-3.html"><a href="week-3.html"><i class="fa fa-check"></i>Week 3</a></li>
<li class="chapter" data-level="6" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html"><i class="fa fa-check"></i><b>6</b> Reading, tidying &amp; joining data</a><ul>
<li class="chapter" data-level="6.1" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#reading-in-data"><i class="fa fa-check"></i><b>6.1</b> Reading in data</a><ul>
<li class="chapter" data-level="6.1.1" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#read_excel"><i class="fa fa-check"></i><b>6.1.1</b> read_excel()</a></li>
<li class="chapter" data-level="6.1.2" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#read_csv"><i class="fa fa-check"></i><b>6.1.2</b> read_csv()</a></li>
<li class="chapter" data-level="6.1.3" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#read_delim"><i class="fa fa-check"></i><b>6.1.3</b> read_delim()</a></li>
<li class="chapter" data-level="6.1.4" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#read_tsv"><i class="fa fa-check"></i><b>6.1.4</b> read_tsv()</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#reshaping-data"><i class="fa fa-check"></i><b>6.2</b> Reshaping data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#pivot_wider"><i class="fa fa-check"></i><b>6.2.1</b> pivot_wider()</a></li>
<li class="chapter" data-level="6.2.2" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#pivot_longer"><i class="fa fa-check"></i><b>6.2.2</b> pivot_longer()</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#separating-and-uniting-columns"><i class="fa fa-check"></i><b>6.3</b> Separating and uniting columns</a><ul>
<li class="chapter" data-level="6.3.1" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#separate"><i class="fa fa-check"></i><b>6.3.1</b> separate()</a></li>
<li class="chapter" data-level="6.3.2" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#str_split-unnest"><i class="fa fa-check"></i><b>6.3.2</b> str_split() %&gt;% unnest()</a></li>
<li class="chapter" data-level="6.3.3" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#rename"><i class="fa fa-check"></i><b>6.3.3</b> rename()</a></li>
<li class="chapter" data-level="6.3.4" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#unite-unite"><i class="fa fa-check"></i><b>6.3.4</b> unite() {unite}</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#removing-variables"><i class="fa fa-check"></i><b>6.4</b> Removing variables</a></li>
<li class="chapter" data-level="6.5" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#joining-dataframes"><i class="fa fa-check"></i><b>6.5</b> Joining dataframes</a><ul>
<li class="chapter" data-level="6.5.1" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#left_join"><i class="fa fa-check"></i><b>6.5.1</b> left_join()</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#plotting-challenge"><i class="fa fa-check"></i><b>6.6</b> Plotting challenge</a></li>
<li class="chapter" data-level="6.7" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#solution-2"><i class="fa fa-check"></i><b>6.7</b> Solution</a></li>
<li class="chapter" data-level="6.8" data-path="reading-tidying-joining-data.html"><a href="reading-tidying-joining-data.html#summary-1"><i class="fa fa-check"></i><b>6.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-4-part-1.html"><a href="week-4-part-1.html"><i class="fa fa-check"></i>Week 4. Part 1</a></li>
<li class="chapter" data-level="7" data-path="automating-your-work.html"><a href="automating-your-work.html"><i class="fa fa-check"></i><b>7</b> Automating your work</a><ul>
<li class="chapter" data-level="7.1" data-path="automating-your-work.html"><a href="automating-your-work.html#experimental-design"><i class="fa fa-check"></i><b>7.1</b> Experimental design</a></li>
<li class="chapter" data-level="7.2" data-path="automating-your-work.html"><a href="automating-your-work.html#for-loops"><i class="fa fa-check"></i><b>7.2</b> For loops</a></li>
<li class="chapter" data-level="7.3" data-path="automating-your-work.html"><a href="automating-your-work.html#paste"><i class="fa fa-check"></i><b>7.3</b> paste()</a></li>
<li class="chapter" data-level="7.4" data-path="automating-your-work.html"><a href="automating-your-work.html#catching-loop-results"><i class="fa fa-check"></i><b>7.4</b> Catching loop results</a><ul>
<li class="chapter" data-level="7.4.1" data-path="automating-your-work.html"><a href="automating-your-work.html#catch-in-vector"><i class="fa fa-check"></i><b>7.4.1</b> Catch in vector</a></li>
<li class="chapter" data-level="7.4.2" data-path="automating-your-work.html"><a href="automating-your-work.html#catch-in-data-frame"><i class="fa fa-check"></i><b>7.4.2</b> Catch in data frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-4-part-2.html"><a href="week-4-part-2.html"><i class="fa fa-check"></i>Week 4. Part 2</a><ul>
<li class="chapter" data-level="7.5" data-path="week-4-part-2.html"><a href="week-4-part-2.html#analyse-plate-1"><i class="fa fa-check"></i><b>7.5</b> Analyse Plate 1</a></li>
<li class="chapter" data-level="7.6" data-path="week-4-part-2.html"><a href="week-4-part-2.html#plotting-the-data"><i class="fa fa-check"></i><b>7.6</b> Plotting the data</a><ul>
<li class="chapter" data-level="7.6.1" data-path="week-4-part-2.html"><a href="week-4-part-2.html#str_remove-helper"><i class="fa fa-check"></i><b>7.6.1</b> str_remove() helper</a></li>
<li class="chapter" data-level="7.6.2" data-path="week-4-part-2.html"><a href="week-4-part-2.html#as.numeric-helper"><i class="fa fa-check"></i><b>7.6.2</b> as.numeric() helper</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="week-4-part-2.html"><a href="week-4-part-2.html#statistical-summary"><i class="fa fa-check"></i><b>7.7</b> Statistical summary</a><ul>
<li class="chapter" data-level="7.7.1" data-path="week-4-part-2.html"><a href="week-4-part-2.html#pull"><i class="fa fa-check"></i><b>7.7.1</b> pull()</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="week-4-part-2.html"><a href="week-4-part-2.html#identify-hits"><i class="fa fa-check"></i><b>7.8</b> Identify hits</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-4-part-3.html"><a href="week-4-part-3.html"><i class="fa fa-check"></i>Week 4. Part 3</a><ul>
<li class="chapter" data-level="7.9" data-path="week-4-part-3.html"><a href="week-4-part-3.html#list.files"><i class="fa fa-check"></i><b>7.9</b> list.files()</a></li>
<li class="chapter" data-level="7.10" data-path="week-4-part-3.html"><a href="week-4-part-3.html#extract-filenames"><i class="fa fa-check"></i><b>7.10</b> Extract filenames</a></li>
<li class="chapter" data-level="7.11" data-path="week-4-part-3.html"><a href="week-4-part-3.html#variable-inputs-outputs"><i class="fa fa-check"></i><b>7.11</b> Variable inputs &amp; outputs</a></li>
<li class="chapter" data-level="7.12" data-path="week-4-part-3.html"><a href="week-4-part-3.html#looping-through-plates"><i class="fa fa-check"></i><b>7.12</b> Looping through plates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="odds-ends.html"><a href="odds-ends.html"><i class="fa fa-check"></i>Odds &amp; Ends</a></li>
<li class="chapter" data-level="8" data-path="factors.html"><a href="factors.html"><i class="fa fa-check"></i><b>8</b> Factors</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R - tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-4.-part-3" class="section level1 unnumbered">
<h1>Week 4. Part 3</h1>
<p>Now that we are happy with the code to analyse and visualize screening plate 1, it’s time to make a few small tweaks to turn the analysis script into a loop.</p>
<p>Remember to load the tidyverse package if you are starting in a fresh Rstudio session:</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb315-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<div id="list.files" class="section level2">
<h2><span class="header-section-number">7.9</span> list.files()</h2>
<p>list.files() is used to check the names of all files in a particular folder.
In order to ‘loop through’ all five screening results files, we first need to store the file names in a variable.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" data-line-number="1"><span class="kw">list.files</span>(<span class="st">&#39;~/Desktop/WEHI_tidyR_course/screening_plates/&#39;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;PLATE1.csv&quot; &quot;PLATE2.csv&quot; &quot;PLATE3.csv&quot; &quot;PLATE4.csv&quot; &quot;PLATE5.csv&quot;</code></pre>
<p>list.files() returns a vector of character values corresponding to file names. To show only the .csv files, we can use <code>pattern = '.csv'</code>. Let’s assign this vector to a variable ‘plate_files’</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" data-line-number="1">plate_files &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="st">&#39;~/Desktop/WEHI_tidyR_course/screening_plates/&#39;</span>, <span class="dt">pattern=</span><span class="st">&#39;.csv&#39;</span>)</a></code></pre></div>
</div>
<div id="extract-filenames" class="section level2">
<h2><span class="header-section-number">7.10</span> Extract filenames</h2>
<p>Downstream we want to write pdf files from ggsave(). Therefore we want to use the file names but not the ‘.csv’ extension. Let’s remove it using str_remove().
The modified values can be assigned to ‘plate_names’</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb319-1" data-line-number="1">plate_names &lt;-<span class="st"> </span><span class="kw">str_remove</span>(plate_files, <span class="dt">pattern =</span> <span class="st">&quot;.csv&quot;</span>)</a></code></pre></div>
</div>
<div id="variable-inputs-outputs" class="section level2">
<h2><span class="header-section-number">7.11</span> Variable inputs &amp; outputs</h2>
<p>After setting up the plate_names vector, it remains to use paste() in place of fixed file names, so that the input and output file names will change as the for loop progresses.</p>
<p>Let’s get a test for loop running, to paste ’_test’ after each filename:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb320-1" data-line-number="1"><span class="cf">for</span>(i <span class="cf">in</span> plate_names){</a>
<a class="sourceLine" id="cb320-2" data-line-number="2"></a>
<a class="sourceLine" id="cb320-3" data-line-number="3">    result_test &lt;-<span class="st"> </span><span class="kw">paste</span>(i, <span class="st">&#39;test&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>)</a>
<a class="sourceLine" id="cb320-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb320-5" data-line-number="5">    <span class="kw">print</span>(result_test)</a>
<a class="sourceLine" id="cb320-6" data-line-number="6">  }</a></code></pre></div>
<pre><code>## [1] &quot;PLATE1_test&quot;
## [1] &quot;PLATE2_test&quot;
## [1] &quot;PLATE3_test&quot;
## [1] &quot;PLATE4_test&quot;
## [1] &quot;PLATE5_test&quot;</code></pre>
<p>The inputs to this script that must vary are the raw data file names (PLATEx.csv).<br />
The outputs that must vary are the filenames given to the ggsave(), and write_csv() commands. Remember that the input files and output files live in different sub-folders. For convenience these lines are reproduced below (no need to run this code):</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb322-1" data-line-number="1">screen_plate &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;~/Desktop/WEHI_tidyR_course/screening_plates/PLATE1.csv&#39;</span>)</a>
<a class="sourceLine" id="cb322-2" data-line-number="2"></a>
<a class="sourceLine" id="cb322-3" data-line-number="3"><span class="kw">ggsave</span>(<span class="st">&#39;~/Desktop/WEHI_tidyR_course/screening_results/plate_tileplot.pdf&#39;</span>, <span class="dt">width=</span><span class="dv">6</span>, <span class="dt">height=</span><span class="fl">3.5</span>)</a>
<a class="sourceLine" id="cb322-4" data-line-number="4"></a>
<a class="sourceLine" id="cb322-5" data-line-number="5"><span class="kw">write_csv</span>(hits, <span class="dt">path =</span> <span class="st">&#39;~/Desktop/WEHI_tidyR_course/screening_results/plate_hits.csv&#39;</span>)</a></code></pre></div>
<p>How can we use paste to allow the input and output file names to vary? To avoid overwriting the results files as the loop progresses, as for the input file name, each output file name must be produced by a paste() command that includes the variable ‘i’.</p>
<p>We can write a for loop that creates a different input file name, and two respective output file names, for each value (‘i’) in the plate_names vector.</p>
<p>The three file names will be stored in variables ‘in_file’, ‘out_plot’ and ‘out_table’.<br />
Given that we want filenames without white space, we will set the paste(sep = ) command to <code>&quot;&quot;</code>, i.e. no space.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb323-1" data-line-number="1"><span class="cf">for</span>(i <span class="cf">in</span> plate_names){</a>
<a class="sourceLine" id="cb323-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb323-3" data-line-number="3">  in_file &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;~/Desktop/WEHI_tidyR_course/screening_plates/&quot;</span>, i,<span class="st">&#39;.csv&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb323-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb323-5" data-line-number="5">  out_plot &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;~/Desktop/WEHI_tidyR_course/screening_results/&quot;</span>, i,<span class="st">&#39;_tileplot.pdf&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb323-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb323-7" data-line-number="7">  out_table &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;~/Desktop/WEHI_tidyR_course/screening_results/&quot;</span>, i,<span class="st">&#39;_hits.csv&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb323-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb323-9" data-line-number="9">  <span class="kw">print</span> (<span class="kw">c</span>(in_file, out_plot, out_table))</a>
<a class="sourceLine" id="cb323-10" data-line-number="10">  </a>
<a class="sourceLine" id="cb323-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb323-12" data-line-number="12">  }</a></code></pre></div>
<pre><code>## [1] &quot;~/Desktop/WEHI_tidyR_course/screening_plates/PLATE1.csv&quot;          
## [2] &quot;~/Desktop/WEHI_tidyR_course/screening_results/PLATE1_tileplot.pdf&quot;
## [3] &quot;~/Desktop/WEHI_tidyR_course/screening_results/PLATE1_hits.csv&quot;    
## [1] &quot;~/Desktop/WEHI_tidyR_course/screening_plates/PLATE2.csv&quot;          
## [2] &quot;~/Desktop/WEHI_tidyR_course/screening_results/PLATE2_tileplot.pdf&quot;
## [3] &quot;~/Desktop/WEHI_tidyR_course/screening_results/PLATE2_hits.csv&quot;    
## [1] &quot;~/Desktop/WEHI_tidyR_course/screening_plates/PLATE3.csv&quot;          
## [2] &quot;~/Desktop/WEHI_tidyR_course/screening_results/PLATE3_tileplot.pdf&quot;
## [3] &quot;~/Desktop/WEHI_tidyR_course/screening_results/PLATE3_hits.csv&quot;    
## [1] &quot;~/Desktop/WEHI_tidyR_course/screening_plates/PLATE4.csv&quot;          
## [2] &quot;~/Desktop/WEHI_tidyR_course/screening_results/PLATE4_tileplot.pdf&quot;
## [3] &quot;~/Desktop/WEHI_tidyR_course/screening_results/PLATE4_hits.csv&quot;    
## [1] &quot;~/Desktop/WEHI_tidyR_course/screening_plates/PLATE5.csv&quot;          
## [2] &quot;~/Desktop/WEHI_tidyR_course/screening_results/PLATE5_tileplot.pdf&quot;
## [3] &quot;~/Desktop/WEHI_tidyR_course/screening_results/PLATE5_hits.csv&quot;</code></pre>
</div>
<div id="looping-through-plates" class="section level2">
<h2><span class="header-section-number">7.12</span> Looping through plates</h2>
<p>Now it’s simply a matter of ‘wrapping’ the existing analysis code within the curly brackets of the for loop, and replacing the file name code with the in_file, out_plot and out_table variables. Note that the intermediate plots, and the code steps from Part 2 that don’t create new variables, are omitted below.</p>
<p>You could create a new .R script called Week_4_analysis_loop.R, copy in the code below and fire away!</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb325-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb325-2" data-line-number="2"></a>
<a class="sourceLine" id="cb325-3" data-line-number="3">plate_files &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="st">&#39;~/Desktop/WEHI_tidyR_course/screening_plates/&#39;</span>, <span class="dt">pattern=</span><span class="st">&#39;.csv&#39;</span>)</a>
<a class="sourceLine" id="cb325-4" data-line-number="4"></a>
<a class="sourceLine" id="cb325-5" data-line-number="5">plate_names &lt;-<span class="st"> </span><span class="kw">str_remove</span>(plate_files, <span class="dt">pattern =</span> <span class="st">&quot;.csv&quot;</span>)</a>
<a class="sourceLine" id="cb325-6" data-line-number="6"></a>
<a class="sourceLine" id="cb325-7" data-line-number="7"><span class="cf">for</span>(i <span class="cf">in</span> plate_names){</a>
<a class="sourceLine" id="cb325-8" data-line-number="8"></a>
<a class="sourceLine" id="cb325-9" data-line-number="9"><span class="co">#set up the variable file names  </span></a>
<a class="sourceLine" id="cb325-10" data-line-number="10">  </a>
<a class="sourceLine" id="cb325-11" data-line-number="11">  in_file &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;~/Desktop/WEHI_tidyR_course/screening_plates/&quot;</span>,   i,<span class="st">&#39;.csv&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb325-12" data-line-number="12">  </a>
<a class="sourceLine" id="cb325-13" data-line-number="13">  out_plot &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;~/Desktop/WEHI_tidyR_course/screening_results/&quot;</span>, i,<span class="st">&#39;_tileplot.pdf&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb325-14" data-line-number="14">  </a>
<a class="sourceLine" id="cb325-15" data-line-number="15">  out_table &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;~/Desktop/WEHI_tidyR_course/screening_results/&quot;</span>, i,<span class="st">&#39;_hits.csv&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb325-16" data-line-number="16">  </a>
<a class="sourceLine" id="cb325-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb325-18" data-line-number="18"></a>
<a class="sourceLine" id="cb325-19" data-line-number="19"><span class="co">#analysis code</span></a>
<a class="sourceLine" id="cb325-20" data-line-number="20">  </a>
<a class="sourceLine" id="cb325-21" data-line-number="21">screen_plate &lt;-<span class="st"> </span><span class="kw">read_csv</span>(in_file)</a>
<a class="sourceLine" id="cb325-22" data-line-number="22"></a>
<a class="sourceLine" id="cb325-23" data-line-number="23"></a>
<a class="sourceLine" id="cb325-24" data-line-number="24">plate_long &lt;-<span class="st"> </span>screen_plate <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-25" data-line-number="25"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">starts_with</span>(<span class="st">&#39;C&#39;</span>), <span class="dt">names_to =</span> <span class="st">&#39;COL&#39;</span>, <span class="dt">values_to =</span> <span class="st">&#39;LUMIN&#39;</span>)</a>
<a class="sourceLine" id="cb325-26" data-line-number="26"></a>
<a class="sourceLine" id="cb325-27" data-line-number="27">plate_long_num &lt;-<span class="st"> </span>plate_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-28" data-line-number="28"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ROW_num =</span> <span class="kw">str_remove</span>(ROW,<span class="st">&#39;R&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">ROW_num =</span> <span class="kw">as.numeric</span>(ROW_num)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-29" data-line-number="29"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">COL_num =</span> <span class="kw">str_remove</span>(COL,<span class="st">&#39;C&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">COL_num =</span> <span class="kw">as.numeric</span>(COL_num))</a>
<a class="sourceLine" id="cb325-30" data-line-number="30"></a>
<a class="sourceLine" id="cb325-31" data-line-number="31">plate_long_num <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-32" data-line-number="32"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>COL_num,<span class="dt">y=</span>ROW_num)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-33" data-line-number="33"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>LUMIN)) <span class="op">+</span></a>
<a class="sourceLine" id="cb325-34" data-line-number="34"><span class="st">  </span><span class="kw">scale_fill_viridis_c</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb325-35" data-line-number="35"><span class="st">  </span><span class="kw">scale_y_reverse</span>()</a>
<a class="sourceLine" id="cb325-36" data-line-number="36"></a>
<a class="sourceLine" id="cb325-37" data-line-number="37"><span class="co">#plot output</span></a>
<a class="sourceLine" id="cb325-38" data-line-number="38"><span class="kw">ggsave</span>(out_plot, <span class="dt">width=</span><span class="dv">6</span>, <span class="dt">height=</span><span class="fl">3.5</span>)</a>
<a class="sourceLine" id="cb325-39" data-line-number="39"></a>
<a class="sourceLine" id="cb325-40" data-line-number="40"></a>
<a class="sourceLine" id="cb325-41" data-line-number="41">plate_tagged &lt;-<span class="st"> </span>plate_long_num <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-42" data-line-number="42"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">well_tag =</span> <span class="kw">case_when</span>(COL_num <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">23</span>,<span class="dv">25</span>,<span class="dv">47</span>) <span class="op">~</span><span class="st"> &#39;posCTRL&#39;</span>,</a>
<a class="sourceLine" id="cb325-43" data-line-number="43">                              COL_num <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">24</span>,<span class="dv">26</span>,<span class="dv">48</span>) <span class="op">~</span><span class="st"> &#39;negCTRL&#39;</span>,</a>
<a class="sourceLine" id="cb325-44" data-line-number="44">                              <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &#39;test&#39;</span>))</a>
<a class="sourceLine" id="cb325-45" data-line-number="45"></a>
<a class="sourceLine" id="cb325-46" data-line-number="46">neg_summ &lt;-<span class="st"> </span>plate_tagged <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-47" data-line-number="47"><span class="st">  </span><span class="kw">filter</span>(well_tag<span class="op">==</span><span class="st">&#39;negCTRL&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-48" data-line-number="48"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_neg =</span> <span class="kw">mean</span>(LUMIN),</a>
<a class="sourceLine" id="cb325-49" data-line-number="49">            <span class="dt">sd_neg=</span> <span class="kw">sd</span>(LUMIN))</a>
<a class="sourceLine" id="cb325-50" data-line-number="50"></a>
<a class="sourceLine" id="cb325-51" data-line-number="51">meanNeg &lt;-<span class="st"> </span>neg_summ <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(mean_neg)</a>
<a class="sourceLine" id="cb325-52" data-line-number="52"></a>
<a class="sourceLine" id="cb325-53" data-line-number="53">sdNeg &lt;-<span class="st"> </span>neg_summ <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(sd_neg)</a>
<a class="sourceLine" id="cb325-54" data-line-number="54"></a>
<a class="sourceLine" id="cb325-55" data-line-number="55">plate_zScores &lt;-<span class="st"> </span>plate_tagged <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-56" data-line-number="56"><span class="st">  </span><span class="kw">filter</span>(well_tag<span class="op">==</span><span class="st">&#39;test&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-57" data-line-number="57"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z_score =</span> (LUMIN <span class="op">-</span><span class="st"> </span>meanNeg) <span class="op">/</span><span class="st"> </span>sdNeg) </a>
<a class="sourceLine" id="cb325-58" data-line-number="58"></a>
<a class="sourceLine" id="cb325-59" data-line-number="59">hits &lt;-<span class="st"> </span>plate_zScores <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(z_score <span class="op">&lt;</span><span class="st"> </span>(<span class="op">-</span><span class="dv">4</span>) <span class="op">|</span><span class="st"> </span>z_score <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb325-60" data-line-number="60"></a>
<a class="sourceLine" id="cb325-61" data-line-number="61"><span class="co">#table output</span></a>
<a class="sourceLine" id="cb325-62" data-line-number="62"><span class="kw">write_csv</span>(hits, <span class="dt">path =</span> out_table)</a>
<a class="sourceLine" id="cb325-63" data-line-number="63"></a>
<a class="sourceLine" id="cb325-64" data-line-number="64">}</a></code></pre></div>
<p>You just processed 6400 experimental results in a couple of seconds 🎉. You can use the time you would have spent copying sheets and formulas in Excel to check the screening_results folder, and start planning the validation experiments for your potential anti-cancer compounds!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-4-part-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="odds-ends.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
